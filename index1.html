<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Aristo Store - Digital Products Marketplace</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700;900&family=Poppins:wght@300;400;500;600;700&family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.15.0/firebase-storage-compat.js"></script>
    
    <!-- Razorpay -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    
    <!-- Canvas Confetti -->
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    
    <style>
        :root {
            --primary-color: #6a11cb;
            --secondary-color: #2575fc;
            --accent-color: #00ffff;
            --dark-bg: #0a0a0f;
            --dark-card: #161622;
            --dark-border: #2a2a3e;
            --text-primary: #ffffff;
            --text-secondary: #b8bcc8;
            --success: #00d68f;
            --warning: #ffaa00;
            --danger: #ff3d71;
            --gradient: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            --shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            --shadow-neon: 0 0 20px rgba(106, 17, 203, 0.5);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', sans-serif;
            background-color: var(--dark-bg);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 15px;
        }

        /* Header */
        header {
            background: var(--dark-card);
            padding: 15px 0;
            box-shadow: var(--shadow);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--dark-border);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .logo i {
            -webkit-text-fill-color: var(--accent-color);
        }

        .search-bar {
            flex: 1;
            max-width: 500px;
            margin: 0 20px;
            position: relative;
        }

        .search-bar input {
            width: 100%;
            padding: 12px 45px 12px 20px;
            border-radius: 30px;
            border: 1px solid var(--dark-border);
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            font-size: 0.9rem;
            transition: all 0.3s ease;
        }

        .search-bar input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 10px rgba(106, 17, 203, 0.3);
        }

        .search-bar button {
            position: absolute;
            right: 5px;
            top: 50%;
            transform: translateY(-50%);
            background: var(--gradient);
            border: none;
            color: white;
            width: 36px;
            height: 36px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .search-bar button:hover {
            transform: translateY(-50%) scale(1.1);
            box-shadow: var(--shadow-neon);
        }

        .header-actions {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .icon-btn {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid var(--dark-border);
            color: var(--text-primary);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .icon-btn:hover {
            background: rgba(106, 17, 203, 0.2);
            border-color: var(--primary-color);
            transform: translateY(-3px);
        }

        .badge {
            position: absolute;
            top: -5px;
            right: -5px;
            background: var(--danger);
            color: white;
            font-size: 0.7rem;
            width: 18px;
            height: 18px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* Main Content */
        main {
            padding-bottom: 80px;
            min-height: calc(100vh - 140px);
        }

        .section {
            padding: 30px 0;
        }

        .section-title {
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.8rem;
            font-weight: 600;
            margin-bottom: 20px;
            position: relative;
            display: inline-block;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 50px;
            height: 3px;
            background: var(--gradient);
            border-radius: 3px;
        }

        /* Categories */
        .categories {
            display: flex;
            gap: 15px;
            overflow-x: auto;
            padding-bottom: 10px;
            margin-bottom: 30px;
            scrollbar-width: none;
        }

        .categories::-webkit-scrollbar {
            display: none;
        }

        .category-card {
            min-width: 100px;
            padding: 15px;
            background: var(--dark-card);
            border-radius: 15px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid var(--dark-border);
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-neon);
            border-color: var(--primary-color);
        }

        .category-card.active {
            background: var(--gradient);
            border-color: transparent;
        }

        .category-card i {
            font-size: 1.5rem;
            margin-bottom: 8px;
            color: var(--accent-color);
        }

        .category-card.active i {
            color: white;
        }

        .category-card span {
            display: block;
            font-size: 0.8rem;
            font-weight: 500;
        }

        /* Product Grid */
        .product-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
        }

        .product-card {
            background: var(--dark-card);
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid var(--dark-border);
            position: relative;
        }

        .product-card:hover {
            transform: translateY(-10px);
            box-shadow: var(--shadow-neon);
            border-color: var(--primary-color);
        }

        .product-image {
            height: 150px;
            width: 100%;
            object-fit: cover;
            background: linear-gradient(135deg, rgba(106, 17, 203, 0.1), rgba(37, 117, 252, 0.1));
        }

        .product-badges {
            position: absolute;
            top: 10px;
            left: 10px;
            display: flex;
            gap: 5px;
        }

        .badge-product {
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.7rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .badge-free {
            background: var(--success);
            color: white;
        }

        .badge-featured {
            background: var(--warning);
            color: white;
        }

        .product-info {
            padding: 15px;
        }

        .product-title {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 8px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .product-price {
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--accent-color);
            margin-bottom: 10px;
        }

        .product-rating {
            display: flex;
            align-items: center;
            gap: 5px;
            margin-bottom: 10px;
        }

        .stars {
            color: var(--warning);
        }

        .rating-count {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .product-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 8px 15px;
            border-radius: 8px;
            border: none;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .btn-primary {
            background: var(--gradient);
            color: white;
            flex: 1;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-neon);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }

        .btn-outline:hover {
            background: rgba(106, 17, 203, 0.1);
        }

        /* Product Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            overflow-y: auto;
            animation: fadeIn 0.3s ease;
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: var(--dark-card);
            border-radius: 20px;
            width: 90%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            position: relative;
            animation: slideUp 0.3s ease;
            border: 1px solid var(--dark-border);
        }

        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: rgba(255, 255, 255, 0.1);
            border: none;
            color: var(--text-primary);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 10;
            transition: all 0.3s ease;
        }

        .modal-close:hover {
            background: var(--danger);
            transform: rotate(90deg);
        }

        .product-gallery {
            position: relative;
            height: 300px;
            overflow: hidden;
        }

        .gallery-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .gallery-nav {
            position: absolute;
            bottom: 15px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 8px;
        }

        .gallery-dot {
            width: 10px;
            height: 10px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.3);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .gallery-dot.active {
            background: var(--accent-color);
            width: 25px;
            border-radius: 5px;
        }

        .product-details {
            padding: 25px;
        }

        .product-header {
            margin-bottom: 20px;
        }

        .product-title-large {
            font-family: 'Rajdhani', sans-serif;
            font-size: 1.8rem;
            font-weight: 700;
            margin-bottom: 10px;
        }

        .product-meta {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
        }

        .product-price-large {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            color: var(--accent-color);
        }

        .product-description {
            margin-bottom: 20px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        .product-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 20px;
        }

        .tag {
            padding: 5px 12px;
            background: rgba(106, 17, 203, 0.2);
            border-radius: 20px;
            font-size: 0.8rem;
            color: var(--primary-color);
        }

        .product-actions-large {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }

        .btn-large {
            padding: 15px 25px;
            font-size: 1rem;
        }

        .reviews-section {
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--dark-border);
        }

        .review-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 15px;
            margin-bottom: 15px;
        }

        .review-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
        }

        .reviewer {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .reviewer-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: 600;
        }

        .reviewer-name {
            font-weight: 600;
        }

        .review-date {
            font-size: 0.8rem;
            color: var(--text-secondary);
        }

        .review-content {
            color: var(--text-secondary);
            line-height: 1.5;
        }

        /* Bottom Navigation */
        .bottom-nav {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--dark-card);
            border-top: 1px solid var(--dark-border);
            display: flex;
            justify-content: space-around;
            padding: 10px 0;
            z-index: 100;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 5px;
            color: var(--text-secondary);
            cursor: pointer;
            transition: all 0.3s ease;
            padding: 5px 10px;
            border-radius: 10px;
        }

        .nav-item:hover {
            color: var(--primary-color);
            background: rgba(106, 17, 203, 0.1);
        }

        .nav-item.active {
            color: var(--accent-color);
        }

        .nav-item i {
            font-size: 1.2rem;
        }

        .nav-item span {
            font-size: 0.7rem;
            font-weight: 500;
        }

        /* Pages */
        .page {
            display: none;
            animation: fadeIn 0.3s ease;
        }

        .page.active {
            display: block;
        }

        /* Profile Page */
        .profile-header {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 30px;
            padding: 20px;
            background: var(--dark-card);
            border-radius: 15px;
            border: 1px solid var(--dark-border);
        }

        .profile-avatar {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: var(--gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 2rem;
            font-weight: 600;
        }

        .profile-info h2 {
            margin-bottom: 5px;
        }

        .profile-info p {
            color: var(--text-secondary);
        }

        .profile-form {
            background: var(--dark-card);
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            border: 1px solid var(--dark-border);
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }

        .form-group input {
            width: 100%;
            padding: 12px 15px;
            border-radius: 10px;
            border: 1px solid var(--dark-border);
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .form-group input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 10px rgba(106, 17, 203, 0.2);
        }

        .btn-block {
            width: 100%;
            padding: 12px;
            font-size: 1rem;
        }

        .btn-danger {
            background: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background: #e6335f;
        }

        /* Orders Page */
        .order-card {
            background: var(--dark-card);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid var(--dark-border);
            transition: all 0.3s ease;
        }

        .order-card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 0 15px rgba(106, 17, 203, 0.2);
        }

        .order-header {
            display: flex;
            justify-content: space-between;
            margin-bottom: 15px;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--dark-border);
        }

        .order-id {
            font-weight: 600;
            color: var(--accent-color);
        }

        .order-date {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .order-status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            text-transform: uppercase;
        }

        .status-completed {
            background: rgba(0, 214, 143, 0.2);
            color: var(--success);
        }

        .status-pending {
            background: rgba(255, 170, 0, 0.2);
            color: var(--warning);
        }

        .status-failed {
            background: rgba(255, 61, 113, 0.2);
            color: var(--danger);
        }

        .order-products {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
        }

        .order-product {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        .order-product-image {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
        }

        .order-product-info {
            flex: 1;
        }

        .order-product-title {
            font-weight: 500;
            margin-bottom: 5px;
        }

        .order-product-price {
            color: var(--accent-color);
            font-weight: 600;
        }

        .order-total {
            display: flex;
            justify-content: space-between;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .order-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        /* Wishlist Page */
        .wishlist-empty {
            text-align: center;
            padding: 50px 20px;
            color: var(--text-secondary);
        }

        .wishlist-empty i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        /* Downloads Page */
        .downloads-empty {
            text-align: center;
            padding: 50px 20px;
            color: var(--text-secondary);
        }

        .downloads-empty i {
            font-size: 3rem;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .download-card {
            background: var(--dark-card);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid var(--dark-border);
            transition: all 0.3s ease;
            display: flex;
            gap: 15px;
            align-items: center;
        }

        .download-card:hover {
            border-color: var(--primary-color);
            box-shadow: 0 0 15px rgba(106, 17, 203, 0.2);
        }

        .download-image {
            width: 80px;
            height: 80px;
            border-radius: 10px;
            object-fit: cover;
        }

        .download-info {
            flex: 1;
        }

        .download-title {
            font-weight: 600;
            margin-bottom: 5px;
            font-size: 1.1rem;
        }

        .download-date {
            color: var(--text-secondary);
            font-size: 0.9rem;
            margin-bottom: 10px;
        }

        .download-actions {
            display: flex;
            gap: 10px;
        }

        /* Settings Page */
        .settings-section {
            background: var(--dark-card);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
            border: 1px solid var(--dark-border);
        }

        .settings-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid var(--dark-border);
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .settings-item:hover {
            background: rgba(106, 17, 203, 0.05);
            margin: 0 -20px;
            padding: 15px 20px;
        }

        .settings-item:last-child {
            border-bottom: none;
        }

        .settings-label {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .settings-label i {
            color: var(--primary-color);
            font-size: 1.2rem;
        }

        .settings-value {
            color: var(--text-secondary);
        }

        /* Auth Forms */
        .auth-container {
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            padding: 20px;
        }

        .auth-card {
            background: var(--dark-card);
            border-radius: 20px;
            padding: 30px;
            width: 100%;
            max-width: 400px;
            border: 1px solid var(--dark-border);
            box-shadow: var(--shadow);
        }

        .auth-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .auth-logo {
            font-family: 'Orbitron', sans-serif;
            font-size: 2rem;
            font-weight: 700;
            background: var(--gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 10px;
        }

        .auth-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 5px;
        }

        .auth-subtitle {
            color: var(--text-secondary);
            font-size: 0.9rem;
        }

        .auth-tabs {
            display: flex;
            margin-bottom: 25px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 10px;
            padding: 5px;
        }

        .auth-tab {
            flex: 1;
            padding: 10px;
            text-align: center;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 500;
        }

        .auth-tab.active {
            background: var(--gradient);
            color: white;
        }

        .auth-form {
            display: none;
        }

        .auth-form.active {
            display: block;
        }

        .btn-auth {
            width: 100%;
            padding: 12px;
            font-size: 1rem;
            margin-top: 10px;
        }

        .auth-divider {
            text-align: center;
            margin: 20px 0;
            position: relative;
        }

        .auth-divider::before {
            content: '';
            position: absolute;
            top: 50%;
            left: 0;
            right: 0;
            height: 1px;
            background: var(--dark-border);
        }

        .auth-divider span {
            background: var(--dark-card);
            padding: 0 15px;
            position: relative;
            color: var(--text-secondary);
        }

        /* Toast Notifications */
        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 2000;
        }

        .toast {
            background: var(--dark-card);
            border-radius: 10px;
            padding: 15px 20px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            min-width: 250px;
            box-shadow: var(--shadow);
            border-left: 4px solid var(--primary-color);
            animation: slideInRight 0.3s ease;
        }

        .toast.success {
            border-left-color: var(--success);
        }

        .toast.error {
            border-left-color: var(--danger);
        }

        .toast.warning {
            border-left-color: var(--warning);
        }

        .toast-icon {
            font-size: 1.2rem;
        }

        .toast.success .toast-icon {
            color: var(--success);
        }

        .toast.error .toast-icon {
            color: var(--danger);
        }

        .toast.warning .toast-icon {
            color: var(--warning);
        }

        .toast-message {
            flex: 1;
        }

        .toast-close {
            background: none;
            border: none;
            color: var(--text-secondary);
            cursor: pointer;
        }

        /* Skeleton Loaders */
        .skeleton {
            background: linear-gradient(90deg, rgba(255, 255, 255, 0.05) 25%, rgba(255, 255, 255, 0.1) 50%, rgba(255, 255, 255, 0.05) 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        .skeleton-text {
            height: 15px;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .skeleton-title {
            height: 20px;
            width: 70%;
            border-radius: 5px;
            margin-bottom: 10px;
        }

        .skeleton-card {
            background: var(--dark-card);
            border-radius: 15px;
            overflow: hidden;
            border: 1px solid var(--dark-border);
        }

        .skeleton-image {
            height: 150px;
            width: 100%;
        }

        .skeleton-content {
            padding: 15px;
        }

        /* Floating Button */
        .floating-btn {
            position: fixed;
            bottom: 90px;
            right: 20px;
            width: 56px;
            height: 56px;
            border-radius: 50%;
            background: var(--gradient);
            color: white;
            border: none;
            box-shadow: var(--shadow);
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
            z-index: 99;
            transition: all 0.3s ease;
        }

        .floating-btn:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-neon);
        }

        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes slideUp {
            from { transform: translateY(30px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @keyframes slideInRight {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* Responsive */
        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 15px;
            }

            .search-bar {
                width: 100%;
                margin: 0;
            }

            .product-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
                gap: 15px;
            }

            .modal-content {
                width: 95%;
                border-radius: 15px;
            }

            .product-gallery {
                height: 200px;
            }

            .product-title-large {
                font-size: 1.4rem;
            }

            .product-price-large {
                font-size: 1.5rem;
            }

            .profile-header {
                flex-direction: column;
                text-align: center;
            }
        }

        @media (max-width: 480px) {
            .product-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .categories {
                gap: 10px;
            }

            .category-card {
                min-width: 80px;
                padding: 10px 5px;
            }

            .section-title {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-rocket"></i>
                    <span>Aristo Store</span>
                </div>
                
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="Search for digital products...">
                    <button id="searchBtn"><i class="fas fa-search"></i></button>
                </div>
                
                <div class="header-actions">
                    <div class="icon-btn" id="cartBtn">
                        <i class="fas fa-shopping-cart"></i>
                        <span class="badge" id="cartCount">0</span>
                    </div>
                    <div class="icon-btn" id="notificationBtn">
                        <i class="fas fa-bell"></i>
                    </div>
                    <div class="icon-btn" id="userBtn">
                        <i class="fas fa-user"></i>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main>
        <div class="container">
            <!-- Home Page -->
            <div id="homePage" class="page active">
                <!-- Categories -->
                <div class="section">
                    <div class="categories" id="categoriesContainer">
                        <!-- Categories will be loaded here -->
                    </div>
                </div>

                <!-- Featured Products -->
                <div class="section">
                    <h2 class="section-title">Featured Products</h2>
                    <div class="product-grid" id="featuredProducts">
                        <!-- Products will be loaded here -->
                    </div>
                </div>

                <!-- All Products -->
                <div class="section">
                    <h2 class="section-title">All Products</h2>
                    <div class="product-grid" id="allProducts">
                        <!-- Products will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Orders Page -->
            <div id="ordersPage" class="page">
                <div class="section">
                    <h2 class="section-title">My Orders</h2>
                    <div id="ordersContainer">
                        <!-- Orders will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Wishlist Page -->
            <div id="wishlistPage" class="page">
                <div class="section">
                    <h2 class="section-title">My Wishlist</h2>
                    <div id="wishlistContainer">
                        <!-- Wishlist items will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Downloads Page -->
            <div id="downloadsPage" class="page">
                <div class="section">
                    <h2 class="section-title">My Downloads</h2>
                    <div id="downloadsContainer">
                        <!-- Downloads will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Profile Page -->
            <div id="profilePage" class="page">
                <div class="section">
                    <div class="profile-header">
                        <div class="profile-avatar" id="profileAvatar">U</div>
                        <div class="profile-info">
                            <h2 id="profileName">User Name</h2>
                            <p id="profileEmail">user@example.com</p>
                        </div>
                    </div>

                    <div class="profile-form">
                        <h3>Edit Profile</h3>
                        <form id="profileForm">
                            <div class="form-group">
                                <label for="nameInput">Full Name</label>
                                <input type="text" id="nameInput" placeholder="Enter your name">
                            </div>
                            <div class="form-group">
                                <label for="phoneInput">Phone Number</label>
                                <input type="tel" id="phoneInput" placeholder="Enter your phone number">
                            </div>
                            <button type="submit" class="btn btn-primary btn-block">Save Changes</button>
                        </form>
                    </div>

                    <div class="profile-form">
                        <h3>Account Actions</h3>
                        <button class="btn btn-outline btn-block" id="changePasswordBtn">Change Password</button>
                        <button class="btn btn-danger btn-block" id="deleteAccountBtn">Delete Account</button>
                    </div>
                </div>
            </div>

            <!-- Settings Page -->
            <div id="settingsPage" class="page">
                <div class="section">
                    <div class="settings-section">
                        <h3>Store Information</h3>
                        <div class="settings-item" id="aboutUsItem">
                            <div class="settings-label">
                                <i class="fas fa-info-circle"></i>
                                <span>About Us</span>
                            </div>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                        <div class="settings-item" id="contactUsItem">
                            <div class="settings-label">
                                <i class="fas fa-envelope"></i>
                                <span>Contact Us</span>
                            </div>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>Legal</h3>
                        <div class="settings-item" id="privacyPolicyItem">
                            <div class="settings-label">
                                <i class="fas fa-shield-alt"></i>
                                <span>Privacy Policy</span>
                            </div>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                        <div class="settings-item" id="termsOfServiceItem">
                            <div class="settings-label">
                                <i class="fas fa-file-contract"></i>
                                <span>Terms of Service</span>
                            </div>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                        <div class="settings-item" id="refundPolicyItem">
                            <div class="settings-label">
                                <i class="fas fa-undo"></i>
                                <span>Refund Policy</span>
                            </div>
                            <i class="fas fa-chevron-right"></i>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>Social Links</h3>
                        <div class="settings-item" id="youtubeItem">
                            <div class="settings-label">
                                <i class="fab fa-youtube"></i>
                                <span>YouTube</span>
                            </div>
                            <i class="fas fa-external-link-alt"></i>
                        </div>
                        <div class="settings-item" id="telegramItem">
                            <div class="settings-label">
                                <i class="fab fa-telegram"></i>
                                <span>Telegram</span>
                            </div>
                            <i class="fas fa-external-link-alt"></i>
                        </div>
                    </div>

                    <div class="settings-section">
                        <h3>App Settings</h3>
                        <div class="settings-item">
                            <div class="settings-label">
                                <i class="fas fa-moon"></i>
                                <span>Dark Mode</span>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="darkModeToggle" checked>
                                <span class="slider round"></span>
                            </label>
                        </div>
                        <div class="settings-item">
                            <div class="settings-label">
                                <i class="fas fa-bell"></i>
                                <span>Push Notifications</span>
                            </div>
                            <label class="switch">
                                <input type="checkbox" id="notificationToggle" checked>
                                <span class="slider round"></span>
                            </label>
                        </div>
                    </div>

                    <div class="profile-form">
                        <button class="btn btn-outline btn-block" id="logoutBtn">Logout</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- Product Modal -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <button class="modal-close" id="closeModal">
                <i class="fas fa-times"></i>
            </button>
            
            <div class="product-gallery">
                <img src="" alt="Product" class="gallery-image" id="galleryImage">
                <div class="gallery-nav" id="galleryNav">
                    <!-- Gallery dots will be added here -->
                </div>
            </div>
            
            <div class="product-details">
                <div class="product-header">
                    <h1 class="product-title-large" id="modalProductTitle">Product Title</h1>
                    <div class="product-meta">
                        <div class="product-price-large" id="modalProductPrice">â‚¹0</div>
                        <div class="product-rating">
                            <div class="stars" id="modalProductStars">
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star"></i>
                                <i class="fas fa-star-half-alt"></i>
                            </div>
                            <span class="rating-count" id="modalProductRating">(0)</span>
                        </div>
                    </div>
                </div>
                
                <div class="product-description" id="modalProductDescription">
                    Product description will appear here...
                </div>
                
                <div class="product-tags" id="modalProductTags">
                    <!-- Tags will be added here -->
                </div>
                
                <div class="product-actions-large">
                    <button class="btn btn-primary btn-large" id="buyNowBtn">
                        <i class="fas fa-shopping-bag"></i>
                        Buy Now
                    </button>
                    <button class="btn btn-outline btn-large" id="addToWishlistBtn">
                        <i class="far fa-heart"></i>
                        Wishlist
                    </button>
                </div>
                
                <div class="reviews-section">
                    <h3>Customer Reviews</h3>
                    <div id="reviewsContainer">
                        <!-- Reviews will be loaded here -->
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Auth Container -->
    <div id="authContainer" class="auth-container">
        <div class="auth-card">
            <div class="auth-header">
                <div class="auth-logo">
                    <i class="fas fa-rocket"></i> Aristo Store
                </div>
                <h2 class="auth-title">Welcome Back</h2>
                <p class="auth-subtitle">Sign in to continue to your account</p>
            </div>
            
            <div class="auth-tabs">
                <div class="auth-tab active" id="loginTab">Login</div>
                <div class="auth-tab" id="signupTab">Sign Up</div>
            </div>
            
            <form class="auth-form active" id="loginForm">
                <div class="form-group">
                    <label for="loginEmail">Email Address</label>
                    <input type="email" id="loginEmail" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label for="loginPassword">Password</label>
                    <input type="password" id="loginPassword" placeholder="Enter your password" required>
                </div>
                <button type="submit" class="btn btn-primary btn-auth">Login</button>
            </form>
            
            <form class="auth-form" id="signupForm">
                <div class="form-group">
                    <label for="signupName">Full Name</label>
                    <input type="text" id="signupName" placeholder="Enter your name" required>
                </div>
                <div class="form-group">
                    <label for="signupEmail">Email Address</label>
                    <input type="email" id="signupEmail" placeholder="Enter your email" required>
                </div>
                <div class="form-group">
                    <label for="signupPassword">Password</label>
                    <input type="password" id="signupPassword" placeholder="Create a password" required>
                </div>
                <button type="submit" class="btn btn-primary btn-auth">Create Account</button>
            </form>
            
            <div class="auth-divider">
                <span>OR</span>
            </div>
            
            <button class="btn btn-outline btn-auth" id="guestLoginBtn">
                <i class="fas fa-user-secret"></i>
                Continue as Guest
            </button>
        </div>
    </div>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="nav-item active" data-page="homePage">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </div>
        <div class="nav-item" data-page="ordersPage">
            <i class="fas fa-shopping-bag"></i>
            <span>Orders</span>
        </div>
        <div class="nav-item" data-page="wishlistPage">
            <i class="fas fa-heart"></i>
            <span>Wishlist</span>
        </div>
        <div class="nav-item" data-page="downloadsPage">
            <i class="fas fa-download"></i>
            <span>Downloads</span>
        </div>
        <div class="nav-item" data-page="profilePage">
            <i class="fas fa-user"></i>
            <span>Profile</span>
        </div>
        <div class="nav-item" data-page="settingsPage">
            <i class="fas fa-cog"></i>
            <span>Settings</span>
        </div>
    </nav>

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer"></div>

    <!-- Floating Button -->
    <button class="floating-btn" id="backToTopBtn">
        <i class="fas fa-arrow-up"></i>
    </button>

    <!-- Legal Pages Modal -->
    <div id="legalModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="legalModalTitle">Legal Page</h2>
                <button class="modal-close" id="closeLegalModal">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="modal-body" id="legalModalContent">
                <!-- Legal content will be loaded here -->
            </div>
        </div>
    </div>

    <script>
        // Firebase Configuration
        const firebaseConfig = {
  apiKey: "AIzaSyAQBRZLxe7fV6KH91oMwkEIB_vim4PHZYM",
  authDomain: "sellify-b3330.firebaseapp.com",
  databaseURL: "https://sellify-b3330-default-rtdb.firebaseio.com",
  projectId: "sellify-b3330",
  storageBucket: "sellify-b3330.firebasestorage.app",
  messagingSenderId: "443143818002",
  appId: "1:443143818002:web:5573a59348fca90aef41cb",
  measurementId: "G-XTPR8F27N6"
};

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        const storage = firebase.storage();

        // App State
        let currentUser = null;
        let products = [];
        let categories = [];
        let cart = [];
        let wishlist = [];
        let orders = [];
        let downloads = [];
        let currentProduct = null;
        let currentGalleryIndex = 0;

        // DOM Elements
        const authContainer = document.getElementById('authContainer');
        const mainContent = document.querySelector('main');
        const pages = document.querySelectorAll('.page');
        const navItems = document.querySelectorAll('.nav-item');
        const productModal = document.getElementById('productModal');
        const toastContainer = document.getElementById('toastContainer');
        const backToTopBtn = document.getElementById('backToTopBtn');
        const legalModal = document.getElementById('legalModal');

        // Initialize App
        document.addEventListener('DOMContentLoaded', () => {
            // Check for existing user session
            auth.onAuthStateChanged(user => {
                if (user) {
                    currentUser = user;
                    loadUserData();
                    showMainContent();
                } else {
                    showAuthContainer();
                }
            });

            // Setup event listeners
            setupEventListeners();
            
            // Load initial data
            loadCategories();
            loadProducts();
        });

        // Setup Event Listeners
        function setupEventListeners() {
            // Auth tabs
            document.getElementById('loginTab').addEventListener('click', () => {
                switchAuthTab('login');
            });
            
            document.getElementById('signupTab').addEventListener('click', () => {
                switchAuthTab('signup');
            });
            
            // Auth forms
            document.getElementById('loginForm').addEventListener('submit', handleLogin);
            document.getElementById('signupForm').addEventListener('submit', handleSignup);
            document.getElementById('guestLoginBtn').addEventListener('click', handleGuestLogin);
            
            // Navigation
            navItems.forEach(item => {
                item.addEventListener('click', () => {
                    const pageId = item.getAttribute('data-page');
                    navigateToPage(pageId);
                });
            });
            
            // Product modal
            document.getElementById('closeModal').addEventListener('click', closeModal);
            productModal.addEventListener('click', (e) => {
                if (e.target === productModal) {
                    closeModal();
                }
            });
            
            // Legal modal
            document.getElementById('closeLegalModal').addEventListener('click', () => {
                legalModal.classList.remove('active');
            });
            
            // Search
            document.getElementById('searchBtn').addEventListener('click', handleSearch);
            document.getElementById('searchInput').addEventListener('keyup', debounce(handleSearch, 500));
            
            // Cart
            document.getElementById('cartBtn').addEventListener('click', () => {
                showToast('Cart feature coming soon!', 'warning');
            });
            
            // Notifications
            document.getElementById('notificationBtn').addEventListener('click', () => {
                showToast('No new notifications', 'info');
            });
            
            // User button
            document.getElementById('userBtn').addEventListener('click', () => {
                navigateToPage('profilePage');
            });
            
            // Profile form
            document.getElementById('profileForm').addEventListener('submit', handleProfileUpdate);
            document.getElementById('changePasswordBtn').addEventListener('click', handleChangePassword);
            document.getElementById('deleteAccountBtn').addEventListener('click', handleDeleteAccount);
            
            // Settings
            document.getElementById('logoutBtn').addEventListener('click', handleLogout);
            document.getElementById('darkModeToggle').addEventListener('change', handleDarkModeToggle);
            document.getElementById('notificationToggle').addEventListener('change', handleNotificationToggle);
            
            // Legal pages
            document.getElementById('aboutUsItem').addEventListener('click', () => {
                showLegalPage('About Us', 'Aristo Store is a futuristic digital marketplace offering premium digital products including templates, graphics, videos, music, e-books, courses, and software. Our mission is to provide high-quality digital resources to creators, businesses, and individuals worldwide.');
            });
            
            document.getElementById('contactUsItem').addEventListener('click', () => {
                showLegalPage('Contact Us', 'Email: support@aristostore.com\nPhone: +91 9876543210\nAddress: 123 Tech Street, Digital City, 560001\n\nWe are available Monday to Friday, 9 AM to 6 PM.');
            });
            
            document.getElementById('privacyPolicyItem').addEventListener('click', () => {
                showLegalPage('Privacy Policy', 'At Aristo Store, we are committed to protecting your privacy. This policy outlines how we collect, use, and protect your information when you use our platform. We collect only necessary information to provide our services and never share your data with third parties without your consent.');
            });
            
            document.getElementById('termsOfServiceItem').addEventListener('click', () => {
                showLegalPage('Terms of Service', 'By using Aristo Store, you agree to these terms. Our platform provides digital products for personal and commercial use as specified in each product license. All sales are final unless otherwise stated. We reserve the right to update these terms at any time.');
            });
            
            document.getElementById('refundPolicyItem').addEventListener('click', () => {
                showLegalPage('Refund Policy', 'We offer refunds within 7 days of purchase if the product is defective or not as described. Digital products that have been downloaded are non-refundable unless there is a technical issue that prevents use. Please contact support for refund requests.');
            });
            
            document.getElementById('youtubeItem').addEventListener('click', () => {
                window.open('https://youtube.com/@aristostore', '_blank');
            });
            
            document.getElementById('telegramItem').addEventListener('click', () => {
                window.open('https://t.me/aristostore', '_blank');
            });
            
            // Back to top
            backToTopBtn.addEventListener('click', () => {
                window.scrollTo({ top: 0, behavior: 'smooth' });
            });
            
            // Show/hide back to top button
            window.addEventListener('scroll', () => {
                if (window.scrollY > 300) {
                    backToTopBtn.style.display = 'flex';
                } else {
                    backToTopBtn.style.display = 'none';
                }
            });
        }

        // Auth Functions
        function switchAuthTab(tab) {
            const loginTab = document.getElementById('loginTab');
            const signupTab = document.getElementById('signupTab');
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');
            const authTitle = document.querySelector('.auth-title');
            const authSubtitle = document.querySelector('.auth-subtitle');
            
            if (tab === 'login') {
                loginTab.classList.add('active');
                signupTab.classList.remove('active');
                loginForm.classList.add('active');
                signupForm.classList.remove('active');
                authTitle.textContent = 'Welcome Back';
                authSubtitle.textContent = 'Sign in to continue to your account';
            } else {
                loginTab.classList.remove('active');
                signupTab.classList.add('active');
                loginForm.classList.remove('active');
                signupForm.classList.add('active');
                authTitle.textContent = 'Create Account';
                authSubtitle.textContent = 'Join us to start shopping';
            }
        }

        function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            auth.signInWithEmailAndPassword(email, password)
                .then(userCredential => {
                    showToast('Login successful!', 'success');
                })
                .catch(error => {
                    showToast(error.message, 'error');
                });
        }

        function handleSignup(e) {
            e.preventDefault();
            const name = document.getElementById('signupName').value;
            const email = document.getElementById('signupEmail').value;
            const password = document.getElementById('signupPassword').value;
            
            auth.createUserWithEmailAndPassword(email, password)
                .then(userCredential => {
                    // Update user profile
                    return userCredential.user.updateProfile({
                        displayName: name
                    });
                })
                .then(() => {
                    // Save user data to Firestore
                    return db.collection('users').doc(auth.currentUser.uid).set({
                        name: name,
                        email: email,
                        phone: '',
                        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                        lastLogin: firebase.firestore.FieldValue.serverTimestamp()
                    });
                })
                .then(() => {
                    showToast('Account created successfully!', 'success');
                })
                .catch(error => {
                    showToast(error.message, 'error');
                });
        }

        function handleGuestLogin() {
            // For demo purposes, we'll create a guest user
            auth.signInAnonymously()
                .then(() => {
                    showToast('Logged in as guest', 'success');
                })
                .catch(error => {
                    showToast(error.message, 'error');
                });
        }

        function handleLogout() {
            auth.signOut()
                .then(() => {
                    showToast('Logged out successfully', 'success');
                })
                .catch(error => {
                    showToast(error.message, 'error');
                });
        }

        // UI Functions
        function showAuthContainer() {
            authContainer.style.display = 'flex';
            mainContent.style.display = 'none';
            document.querySelector('header').style.display = 'none';
            document.querySelector('.bottom-nav').style.display = 'none';
        }

        function showMainContent() {
            authContainer.style.display = 'none';
            mainContent.style.display = 'block';
            document.querySelector('header').style.display = 'block';
            document.querySelector('.bottom-nav').style.display = 'flex';
        }

        function navigateToPage(pageId) {
            // Update active nav item
            navItems.forEach(item => {
                item.classList.remove('active');
                if (item.getAttribute('data-page') === pageId) {
                    item.classList.add('active');
                }
            });
            
            // Show selected page
            pages.forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(pageId).classList.add('active');
            
            // Load page-specific data
            if (pageId === 'ordersPage') {
                loadOrders();
            } else if (pageId === 'wishlistPage') {
                loadWishlist();
            } else if (pageId === 'downloadsPage') {
                loadDownloads();
            } else if (pageId === 'profilePage') {
                loadProfile();
            } else if (pageId === 'settingsPage') {
                loadSettings();
            }
        }

        // Data Loading Functions
        function loadCategories() {
            // In a real app, this would fetch from Firestore
            // For demo, we'll use static data
            categories = [
                { id: 'all', name: 'All', icon: 'fas fa-th' },
                { id: 'templates', name: 'Templates', icon: 'fas fa-file-code' },
                { id: 'graphics', name: 'Graphics', icon: 'fas fa-image' },
                { id: 'videos', name: 'Videos', icon: 'fas fa-video' },
                { id: 'music', name: 'Music', icon: 'fas fa-music' },
                { id: 'ebooks', name: 'E-books', icon: 'fas fa-book' },
                { id: 'courses', name: 'Courses', icon: 'fas fa-graduation-cap' },
                { id: 'software', name: 'Software', icon: 'fas fa-desktop' }
            ];
            
            renderCategories();
        }

        function renderCategories() {
            const container = document.getElementById('categoriesContainer');
            container.innerHTML = '';
            
            categories.forEach(category => {
                const categoryCard = document.createElement('div');
                categoryCard.className = `category-card ${category.id === 'all' ? 'active' : ''}`;
                categoryCard.innerHTML = `
                    <i class="${category.icon}"></i>
                    <span>${category.name}</span>
                `;
                
                categoryCard.addEventListener('click', () => {
                    // Update active category
                    document.querySelectorAll('.category-card').forEach(card => {
                        card.classList.remove('active');
                    });
                    categoryCard.classList.add('active');
                    
                    // Filter products
                    filterProducts(category.id);
                });
                
                container.appendChild(categoryCard);
            });
        }

        function loadProducts() {
            // Show skeleton loaders
            showProductSkeletons();
            
            // In a real app, this would fetch from Firestore
            // For demo, we'll use static data
            setTimeout(() => {
                products = [
                    {
                        id: '1',
                        title: 'Premium Website Template',
                        description: 'A modern, responsive website template built with HTML, CSS, and JavaScript. Perfect for businesses, portfolios, and blogs.',
                        price: 2999,
                        category: 'templates',
                        images: [
                            'https://picsum.photos/seed/template1/800/600.jpg',
                            'https://picsum.photos/seed/template2/800/600.jpg',
                            'https://picsum.photos/seed/template3/800/600.jpg'
                        ],
                        tags: ['HTML', 'CSS', 'JavaScript', 'Responsive'],
                        rating: 4.5,
                        reviewCount: 24,
                        isFree: false,
                        isFeatured: true,
                        downloadUrl: 'https://example.com/download/template1',
                        razorpayId: 'rzp_template1'
                    },
                    {
                        id: '2',
                        title: 'Social Media Graphics Pack',
                        description: 'A collection of 100+ high-quality social media graphics for Instagram, Facebook, Twitter, and more.',
                        price: 0,
                        category: 'graphics',
                        images: [
                            'https://picsum.photos/seed/graphics1/800/600.jpg',
                            'https://picsum.photos/seed/graphics2/800/600.jpg'
                        ],
                        tags: ['Social Media', 'Graphics', 'Marketing'],
                        rating: 4.8,
                        reviewCount: 56,
                        isFree: true,
                        isFeatured: true,
                        downloadUrl: 'https://example.com/download/graphics1',
                        razorpayId: ''
                    },
                    {
                        id: '3',
                        title: 'Video Editing Course',
                        description: 'Learn professional video editing techniques with this comprehensive course covering all major editing software.',
                        price: 4999,
                        category: 'courses',
                        images: [
                            'https://picsum.photos/seed/course1/800/600.jpg',
                            'https://picsum.photos/seed/course2/800/600.jpg'
                        ],
                        tags: ['Video', 'Editing', 'Course', 'Tutorial'],
                        rating: 4.7,
                        reviewCount: 89,
                        isFree: false,
                        isFeatured: false,
                        downloadUrl: 'https://example.com/download/course1',
                        razorpayId: 'rzp_course1'
                    },
                    {
                        id: '4',
                        title: 'Royalty-Free Music Collection',
                        description: 'A collection of 50+ royalty-free music tracks perfect for videos, podcasts, and presentations.',
                        price: 1999,
                        category: 'music',
                        images: [
                            'https://picsum.photos/seed/music1/800/600.jpg'
                        ],
                        tags: ['Music', 'Royalty-Free', 'Audio'],
                        rating: 4.3,
                        reviewCount: 32,
                        isFree: false,
                        isFeatured: false,
                        downloadUrl: 'https://example.com/download/music1',
                        razorpayId: 'rzp_music1'
                    },
                    {
                        id: '5',
                        title: 'E-book: Digital Marketing Guide',
                        description: 'A comprehensive guide to digital marketing strategies, SEO, social media marketing, and more.',
                        price: 0,
                        category: 'ebooks',
                        images: [
                            'https://picsum.photos/seed/ebook1/800/600.jpg'
                        ],
                        tags: ['E-book', 'Marketing', 'Digital', 'Guide'],
                        rating: 4.6,
                        reviewCount: 41,
                        isFree: true,
                        isFeatured: false,
                        downloadUrl: 'https://example.com/download/ebook1',
                        razorpayId: ''
                    },
                    {
                        id: '6',
                        title: 'Productivity Software Suite',
                        description: 'A suite of productivity tools including task manager, note-taking app, and calendar.',
                        price: 3999,
                        category: 'software',
                        images: [
                            'https://picsum.photos/seed/software1/800/600.jpg',
                            'https://picsum.photos/seed/software2/800/600.jpg'
                        ],
                        tags: ['Software', 'Productivity', 'Tools'],
                        rating: 4.4,
                        reviewCount: 18,
                        isFree: false,
                        isFeatured: true,
                        downloadUrl: 'https://example.com/download/software1',
                        razorpayId: 'rzp_software1'
                    }
                ];
                
                renderProducts();
            }, 1500);
        }

        function showProductSkeletons() {
            const featuredContainer = document.getElementById('featuredProducts');
            const allContainer = document.getElementById('allProducts');
            
            // Create skeleton cards
            const skeletonCard = `
                <div class="skeleton-card">
                    <div class="skeleton skeleton-image"></div>
                    <div class="skeleton-content">
                        <div class="skeleton skeleton-title"></div>
                        <div class="skeleton skeleton-text"></div>
                        <div class="skeleton skeleton-text" style="width: 60%;"></div>
                    </div>
                </div>
            `;
            
            // Add 4 skeleton cards to each container
            for (let i = 0; i < 4; i++) {
                featuredContainer.innerHTML += skeletonCard;
                allContainer.innerHTML += skeletonCard;
            }
        }

        function renderProducts() {
            const featuredContainer = document.getElementById('featuredProducts');
            const allContainer = document.getElementById('allProducts');
            
            // Clear containers
            featuredContainer.innerHTML = '';
            allContainer.innerHTML = '';
            
            // Filter featured products
            const featuredProducts = products.filter(product => product.isFeatured);
            
            // Render featured products
            featuredProducts.forEach(product => {
                featuredContainer.appendChild(createProductCard(product));
            });
            
            // Render all products
            products.forEach(product => {
                allContainer.appendChild(createProductCard(product));
            });
        }

        function createProductCard(product) {
            const card = document.createElement('div');
            card.className = 'product-card';
            
            // Create badges HTML
            let badgesHTML = '';
            if (product.isFree) {
                badgesHTML += `<span class="badge-product badge-free">Free</span>`;
            }
            if (product.isFeatured) {
                badgesHTML += `<span class="badge-product badge-featured">Featured</span>`;
            }
            
            // Create stars HTML
            let starsHTML = '';
            const fullStars = Math.floor(product.rating);
            const hasHalfStar = product.rating % 1 !== 0;
            
            for (let i = 0; i < fullStars; i++) {
                starsHTML += '<i class="fas fa-star"></i>';
            }
            if (hasHalfStar) {
                starsHTML += '<i class="fas fa-star-half-alt"></i>';
            }
            const emptyStars = 5 - Math.ceil(product.rating);
            for (let i = 0; i < emptyStars; i++) {
                starsHTML += '<i class="far fa-star"></i>';
            }
            
            card.innerHTML = `
                <div class="product-badges">${badgesHTML}</div>
                <img src="${product.images[0]}" alt="${product.title}" class="product-image">
                <div class="product-info">
                    <h3 class="product-title">${product.title}</h3>
                    <div class="product-price">${product.isFree ? 'Free' : 'â‚¹' + product.price}</div>
                    <div class="product-rating">
                        <div class="stars">${starsHTML}</div>
                        <span class="rating-count">(${product.reviewCount})</span>
                    </div>
                    <div class="product-actions">
                        <button class="btn btn-primary" data-id="${product.id}">
                            ${product.isFree ? 'Get Now' : 'Buy Now'}
                        </button>
                        <button class="btn btn-outline wishlist-btn" data-id="${product.id}">
                            <i class="far fa-heart"></i>
                        </button>
                    </div>
                </div>
            `;
            
            // Add event listeners
            const buyBtn = card.querySelector('.btn-primary');
            const wishlistBtn = card.querySelector('.wishlist-btn');
            
            buyBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                handleProductAction(product);
            });
            
            wishlistBtn.addEventListener('click', (e) => {
                e.stopPropagation();
                toggleWishlist(product.id, wishlistBtn);
            });
            
            card.addEventListener('click', () => {
                openProductModal(product);
            });
            
            return card;
        }

        function filterProducts(categoryId) {
            const allProducts = document.querySelectorAll('#allProducts .product-card');
            
            allProducts.forEach(card => {
                if (categoryId === 'all') {
                    card.style.display = 'block';
                } else {
                    const productId = card.querySelector('.btn-primary').getAttribute('data-id');
                    const product = products.find(p => p.id === productId);
                    
                    if (product && product.category === categoryId) {
                        card.style.display = 'block';
                    } else {
                        card.style.display = 'none';
                    }
                }
            });
        }

        function handleProductAction(product) {
            if (product.isFree) {
                // Download free product
                downloadProduct(product);
            } else {
                // Initiate payment
                initiatePayment(product);
            }
        }

        function downloadProduct(product) {
            // In a real app, this would handle the download
            showToast(`Downloading ${product.title}...`, 'success');
            
            // Log download
            if (currentUser) {
                db.collection('downloads').add({
                    userId: currentUser.uid,
                    productId: product.id,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                // Add to downloads array
                downloads.push({
                    id: product.id,
                    title: product.title,
                    image: product.images[0],
                    downloadDate: new Date(),
                    downloadUrl: product.downloadUrl
                });
            }
            
            // Trigger confetti
            confetti({
                particleCount: 100,
                spread: 70,
                origin: { y: 0.6 }
            });
            
            // Simulate download
            setTimeout(() => {
                showToast(`${product.title} downloaded successfully!`, 'success');
            }, 2000);
        }

        function initiatePayment(product) {
            // In a real app, this would integrate with Razorpay
            showToast(`Initiating payment for ${product.title}...`, 'info');
            
            // Simulate payment process
            setTimeout(() => {
                // Simulate successful payment
                showToast('Payment successful! Downloading...', 'success');
                
                // Log order
                if (currentUser) {
                    db.collection('orders').add({
                        userId: currentUser.uid,
                        productId: product.id,
                        amount: product.price,
                        status: 'completed',
                        timestamp: firebase.firestore.FieldValue.serverTimestamp()
                    });
                    
                    // Add to downloads array
                    downloads.push({
                        id: product.id,
                        title: product.title,
                        image: product.images[0],
                        downloadDate: new Date(),
                        downloadUrl: product.downloadUrl
                    });
                }
                
                // Trigger confetti
                confetti({
                    particleCount: 100,
                    spread: 70,
                    origin: { y: 0.6 }
                });
                
                // Simulate download
                setTimeout(() => {
                    showToast(`${product.title} downloaded successfully!`, 'success');
                }, 2000);
            }, 3000);
        }

        function toggleWishlist(productId, button) {
            if (!currentUser) {
                showToast('Please login to add items to wishlist', 'warning');
                return;
            }
            
            const index = wishlist.indexOf(productId);
            
            if (index === -1) {
                // Add to wishlist
                wishlist.push(productId);
                button.innerHTML = '<i class="fas fa-heart"></i>';
                showToast('Added to wishlist', 'success');
                
                // Update in Firestore
                db.collection('users').doc(currentUser.uid).update({
                    wishlist: firebase.firestore.FieldValue.arrayUnion(productId)
                });
            } else {
                // Remove from wishlist
                wishlist.splice(index, 1);
                button.innerHTML = '<i class="far fa-heart"></i>';
                showToast('Removed from wishlist', 'info');
                
                // Update in Firestore
                db.collection('users').doc(currentUser.uid).update({
                    wishlist: firebase.firestore.FieldValue.arrayRemove(productId)
                });
            }
        }

        function openProductModal(product) {
            currentProduct = product;
            currentGalleryIndex = 0;
            
            // Update modal content
            document.getElementById('modalProductTitle').textContent = product.title;
            document.getElementById('modalProductPrice').textContent = product.isFree ? 'Free' : 'â‚¹' + product.price;
            document.getElementById('modalProductDescription').textContent = product.description;
            
            // Update rating
            const fullStars = Math.floor(product.rating);
            const hasHalfStar = product.rating % 1 !== 0;
            let starsHTML = '';
            
            for (let i = 0; i < fullStars; i++) {
                starsHTML += '<i class="fas fa-star"></i>';
            }
            if (hasHalfStar) {
                starsHTML += '<i class="fas fa-star-half-alt"></i>';
            }
            const emptyStars = 5 - Math.ceil(product.rating);
            for (let i = 0; i < emptyStars; i++) {
                starsHTML += '<i class="far fa-star"></i>';
            }
            
            document.getElementById('modalProductStars').innerHTML = starsHTML;
            document.getElementById('modalProductRating').textContent = `(${product.reviewCount})`;
            
            // Update gallery
            updateGallery();
            
            // Update tags
            const tagsContainer = document.getElementById('modalProductTags');
            tagsContainer.innerHTML = '';
            product.tags.forEach(tag => {
                const tagElement = document.createElement('span');
                tagElement.className = 'tag';
                tagElement.textContent = tag;
                tagsContainer.appendChild(tagElement);
            });
            
            // Update wishlist button
            const isInWishlist = wishlist.includes(product.id);
            document.getElementById('addToWishlistBtn').innerHTML = isInWishlist ? 
                '<i class="fas fa-heart"></i> Remove from Wishlist' : 
                '<i class="far fa-heart"></i> Add to Wishlist';
            
            // Update buy button
            document.getElementById('buyNowBtn').innerHTML = product.isFree ? 
                '<i class="fas fa-download"></i> Download Now' : 
                '<i class="fas fa-shopping-bag"></i> Buy Now';
            
            // Load reviews
            loadReviews(product.id);
            
            // Show modal
            productModal.classList.add('active');
        }

        function updateGallery() {
            if (!currentProduct) return;
            
            const galleryImage = document.getElementById('galleryImage');
            const galleryNav = document.getElementById('galleryNav');
            
            // Update image
            galleryImage.src = currentProduct.images[currentGalleryIndex];
            
            // Update navigation dots
            galleryNav.innerHTML = '';
            currentProduct.images.forEach((image, index) => {
                const dot = document.createElement('div');
                dot.className = `gallery-dot ${index === currentGalleryIndex ? 'active' : ''}`;
                dot.addEventListener('click', () => {
                    currentGalleryIndex = index;
                    updateGallery();
                });
                galleryNav.appendChild(dot);
            });
        }

        function closeModal() {
            productModal.classList.remove('active');
            currentProduct = null;
        }

        function loadReviews(productId) {
            const reviewsContainer = document.getElementById('reviewsContainer');
            
            // In a real app, this would fetch from Firestore
            // For demo, we'll use static data
            const reviews = [
                {
                    id: '1',
                    productId: productId,
                    userId: 'user1',
                    userName: 'John Doe',
                    rating: 5,
                    comment: 'Excellent product! Exactly what I was looking for.',
                    timestamp: new Date('2023-05-15')
                },
                {
                    id: '2',
                    productId: productId,
                    userId: 'user2',
                    userName: 'Jane Smith',
                    rating: 4,
                    comment: 'Great quality and easy to use. Highly recommend!',
                    timestamp: new Date('2023-05-10')
                },
                {
                    id: '3',
                    productId: productId,
                    userId: 'user3',
                    userName: 'Mike Johnson',
                    rating: 4,
                    comment: 'Good value for money. The product met my expectations.',
                    timestamp: new Date('2023-05-05')
                }
            ];
            
            reviewsContainer.innerHTML = '';
            
            reviews.forEach(review => {
                const reviewCard = document.createElement('div');
                reviewCard.className = 'review-card';
                
                // Create stars HTML
                let starsHTML = '';
                for (let i = 0; i < review.rating; i++) {
                    starsHTML += '<i class="fas fa-star"></i>';
                }
                for (let i = review.rating; i < 5; i++) {
                    starsHTML += '<i class="far fa-star"></i>';
                }
                
                reviewCard.innerHTML = `
                    <div class="review-header">
                        <div class="reviewer">
                            <div class="reviewer-avatar">${review.userName.charAt(0)}</div>
                            <div>
                                <div class="reviewer-name">${review.userName}</div>
                                <div class="review-date">${formatDate(review.timestamp)}</div>
                            </div>
                        </div>
                        <div class="stars">${starsHTML}</div>
                    </div>
                    <div class="review-content">${review.comment}</div>
                `;
                
                reviewsContainer.appendChild(reviewCard);
            });
        }

        function loadOrders() {
            const container = document.getElementById('ordersContainer');
            
            if (!currentUser) {
                container.innerHTML = '<p>Please login to view your orders</p>';
                return;
            }
            
            // Show loading state
            container.innerHTML = '<p>Loading your orders...</p>';
            
            // In a real app, this would fetch from Firestore
            // For demo, we'll use static data
            setTimeout(() => {
                orders = [
                    {
                        id: 'order1',
                        userId: currentUser.uid,
                        items: [
                            {
                                productId: '1',
                                title: 'Premium Website Template',
                                price: 2999,
                                image: 'https://picsum.photos/seed/template1/100/100.jpg'
                            }
                        ],
                        totalAmount: 2999,
                        status: 'completed',
                        timestamp: new Date('2023-05-20')
                    },
                    {
                        id: 'order2',
                        userId: currentUser.uid,
                        items: [
                            {
                                productId: '2',
                                title: 'Social Media Graphics Pack',
                                price: 0,
                                image: 'https://picsum.photos/seed/graphics1/100/100.jpg'
                            }
                        ],
                        totalAmount: 0,
                        status: 'completed',
                        timestamp: new Date('2023-05-15')
                    },
                    {
                        id: 'order3',
                        userId: currentUser.uid,
                        items: [
                            {
                                productId: '3',
                                title: 'Video Editing Course',
                                price: 4999,
                                image: 'https://picsum.photos/seed/course1/100/100.jpg'
                            }
                        ],
                        totalAmount: 4999,
                        status: 'pending',
                        timestamp: new Date('2023-05-25')
                    }
                ];
                
                renderOrders();
            }, 1000);
        }

        function renderOrders() {
            const container = document.getElementById('ordersContainer');
            container.innerHTML = '';
            
            if (orders.length === 0) {
                container.innerHTML = '<p>You haven\'t placed any orders yet</p>';
                return;
            }
            
            orders.forEach(order => {
                const orderCard = document.createElement('div');
                orderCard.className = 'order-card';
                
                // Create status class
                let statusClass = '';
                if (order.status === 'completed') {
                    statusClass = 'status-completed';
                } else if (order.status === 'pending') {
                    statusClass = 'status-pending';
                } else {
                    statusClass = 'status-failed';
                }
                
                // Create order items HTML
                let itemsHTML = '';
                order.items.forEach(item => {
                    itemsHTML += `
                        <div class="order-product">
                            <img src="${item.image}" alt="${item.title}" class="order-product-image">
                            <div class="order-product-info">
                                <div class="order-product-title">${item.title}</div>
                                <div class="order-product-price">${item.price === 0 ? 'Free' : 'â‚¹' + item.price}</div>
                            </div>
                        </div>
                    `;
                });
                
                orderCard.innerHTML = `
                    <div class="order-header">
                        <div>
                            <div class="order-id">Order #${order.id}</div>
                            <div class="order-date">${formatDate(order.timestamp)}</div>
                        </div>
                        <div class="order-status ${statusClass}">${order.status}</div>
                    </div>
                    <div class="order-products">${itemsHTML}</div>
                    <div class="order-total">
                        <span>Total:</span>
                        <span>${order.totalAmount === 0 ? 'Free' : 'â‚¹' + order.totalAmount}</span>
                    </div>
                    <div class="order-actions">
                        ${order.status === 'completed' ? 
                            `<button class="btn btn-primary" data-id="${order.id}">Download</button>` : 
                            `<button class="btn btn-outline" data-id="${order.id}">Track Order</button>`
                        }
                        <button class="btn btn-outline" data-id="${order.id}">View Details</button>
                    </div>
                `;
                
                // Add event listeners
                const buttons = orderCard.querySelectorAll('.btn');
                buttons.forEach(button => {
                    button.addEventListener('click', () => {
                        const action = button.textContent.trim();
                        handleOrderAction(order.id, action);
                    });
                });
                
                container.appendChild(orderCard);
            });
        }

        function handleOrderAction(orderId, action) {
            if (action === 'Download') {
                showToast('Preparing download...', 'info');
                setTimeout(() => {
                    showToast('Download started!', 'success');
                }, 1500);
            } else if (action === 'Track Order') {
                showToast('Tracking information will be available soon', 'info');
            } else if (action === 'View Details') {
                showToast(`Viewing details for order #${orderId}`, 'info');
            }
        }

        function loadWishlist() {
            const container = document.getElementById('wishlistContainer');
            
            if (!currentUser) {
                container.innerHTML = '<p>Please login to view your wishlist</p>';
                return;
            }
            
            // Show loading state
            container.innerHTML = '<p>Loading your wishlist...</p>';
            
            // In a real app, this would fetch from Firestore
            // For demo, we'll use static data
            setTimeout(() => {
                // Get wishlist items
                const wishlistItems = products.filter(product => wishlist.includes(product.id));
                
                if (wishlistItems.length === 0) {
                    container.innerHTML = `
                        <div class="wishlist-empty">
                            <i class="fas fa-heart"></i>
                            <h3>Your wishlist is empty</h3>
                            <p>Add items to your wishlist to keep track of them</p>
                            <button class="btn btn-primary" onclick="navigateToPage('homePage')">Browse Products</button>
                        </div>
                    `;
                    return;
                }
                
                // Create product grid
                const productGrid = document.createElement('div');
                productGrid.className = 'product-grid';
                
                wishlistItems.forEach(product => {
                    productGrid.appendChild(createProductCard(product));
                });
                
                container.innerHTML = '';
                container.appendChild(productGrid);
            }, 1000);
        }

        function loadDownloads() {
            const container = document.getElementById('downloadsContainer');
            
            if (!currentUser) {
                container.innerHTML = '<p>Please login to view your downloads</p>';
                return;
            }
            
            // Show loading state
            container.innerHTML = '<p>Loading your downloads...</p>';
            
            // In a real app, this would fetch from Firestore
            // For demo, we'll use static data
            setTimeout(() => {
                // If no downloads yet, show empty state
                if (downloads.length === 0) {
                    container.innerHTML = `
                        <div class="downloads-empty">
                            <i class="fas fa-download"></i>
                            <h3>No downloads yet</h3>
                            <p>Your downloaded products will appear here</p>
                            <button class="btn btn-primary" onclick="navigateToPage('homePage')">Browse Products</button>
                        </div>
                    `;
                    return;
                }
                
                // Render downloads
                container.innerHTML = '';
                
                downloads.forEach(download => {
                    const downloadCard = document.createElement('div');
                    downloadCard.className = 'download-card';
                    
                    downloadCard.innerHTML = `
                        <img src="${download.image}" alt="${download.title}" class="download-image">
                        <div class="download-info">
                            <h3 class="download-title">${download.title}</h3>
                            <p class="download-date">Downloaded on ${formatDate(download.downloadDate)}</p>
                            <div class="download-actions">
                                <button class="btn btn-primary" data-url="${download.downloadUrl}">
                                    <i class="fas fa-download"></i> Download Again
                                </button>
                                <button class="btn btn-outline" data-id="${download.id}">
                                    <i class="fas fa-share-alt"></i> Share
                                </button>
                            </div>
                        </div>
                    `;
                    
                    // Add event listeners
                    const downloadBtn = downloadCard.querySelector('.btn-primary');
                    const shareBtn = downloadCard.querySelector('.btn-outline');
                    
                    downloadBtn.addEventListener('click', () => {
                        const url = downloadBtn.getAttribute('data-url');
                        window.open(url, '_blank');
                        showToast('Download started!', 'success');
                    });
                    
                    shareBtn.addEventListener('click', () => {
                        if (navigator.share) {
                            navigator.share({
                                title: download.title,
                                text: `Check out this product: ${download.title}`,
                                url: window.location.href
                            });
                        } else {
                            // Fallback for browsers that don't support Web Share API
                            const dummy = document.createElement('input');
                            document.body.appendChild(dummy);
                            dummy.value = window.location.href;
                            dummy.select();
                            document.execCommand('copy');
                            document.body.removeChild(dummy);
                            showToast('Link copied to clipboard!', 'success');
                        }
                    });
                    
                    container.appendChild(downloadCard);
                });
            }, 1000);
        }

        function loadProfile() {
            if (!currentUser) {
                showToast('Please login to view your profile', 'warning');
                return;
            }
            
            // Update profile info
            document.getElementById('profileName').textContent = currentUser.displayName || 'User';
            document.getElementById('profileEmail').textContent = currentUser.email;
            
            // Update avatar
            const avatar = document.getElementById('profileAvatar');
            avatar.textContent = (currentUser.displayName || 'User').charAt(0).toUpperCase();
            
            // Update form fields
            document.getElementById('nameInput').value = currentUser.displayName || '';
            document.getElementById('phoneInput').value = '';
            
            // Load user data from Firestore
            db.collection('users').doc(currentUser.uid).get()
                .then(doc => {
                    if (doc.exists) {
                        const userData = doc.data();
                        document.getElementById('phoneInput').value = userData.phone || '';
                    }
                })
                .catch(error => {
                    console.error('Error loading user data:', error);
                });
        }

        function handleProfileUpdate(e) {
            e.preventDefault();
            
            const name = document.getElementById('nameInput').value;
            const phone = document.getElementById('phoneInput').value;
            
            // Update display name in Firebase Auth
            currentUser.updateProfile({
                displayName: name
            })
            .then(() => {
                // Update user data in Firestore
                return db.collection('users').doc(currentUser.uid).update({
                    name: name,
                    phone: phone,
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                });
            })
            .then(() => {
                showToast('Profile updated successfully!', 'success');
                loadProfile();
            })
            .catch(error => {
                showToast(error.message, 'error');
            });
        }

        function handleChangePassword() {
            // In a real app, this would send a password reset email
            auth.sendPasswordResetEmail(currentUser.email)
                .then(() => {
                    showToast('Password reset email sent!', 'success');
                })
                .catch(error => {
                    showToast(error.message, 'error');
                });
        }

        function handleDeleteAccount() {
            if (confirm('Are you sure you want to delete your account? This action cannot be undone.')) {
                // Delete user data from Firestore
                db.collection('users').doc(currentUser.uid).delete()
                    .then(() => {
                        // Delete user account
                        return currentUser.delete();
                    })
                    .then(() => {
                        showToast('Account deleted successfully', 'success');
                    })
                    .catch(error => {
                        showToast(error.message, 'error');
                    });
            }
        }

        function loadSettings() {
            // In a real app, this would load settings from Firestore
            // For demo, we'll use static values
            
            // Load dark mode setting
            const darkModeToggle = document.getElementById('darkModeToggle');
            darkModeToggle.checked = true; // Default to dark mode
            
            // Load notification setting
            const notificationToggle = document.getElementById('notificationToggle');
            notificationToggle.checked = true; // Default to enabled
        }

        function handleDarkModeToggle(e) {
            const isDarkMode = e.target.checked;
            
            if (isDarkMode) {
                document.body.classList.remove('light-mode');
                showToast('Dark mode enabled', 'success');
            } else {
                document.body.classList.add('light-mode');
                showToast('Light mode enabled', 'success');
            }
            
            // In a real app, this would save the setting to Firestore
        }

        function handleNotificationToggle(e) {
            const isEnabled = e.target.checked;
            
            if (isEnabled) {
                showToast('Notifications enabled', 'success');
            } else {
                showToast('Notifications disabled', 'info');
            }
            
            // In a real app, this would save the setting to Firestore
        }

        function loadUserData() {
            if (!currentUser) return;
            
            // Load user data from Firestore
            db.collection('users').doc(currentUser.uid).get()
                .then(doc => {
                    if (doc.exists) {
                        const userData = doc.data();
                        
                        // Load wishlist
                        if (userData.wishlist) {
                            wishlist = userData.wishlist;
                        }
                        
                        // Load cart
                        if (userData.cart) {
                            cart = userData.cart;
                            updateCartCount();
                        }
                    }
                })
                .catch(error => {
                    console.error('Error loading user data:', error);
                });
            
            // Load downloads from Firestore
            db.collection('downloads')
                .where('userId', '==', currentUser.uid)
                .get()
                .then(querySnapshot => {
                    downloads = [];
                    querySnapshot.forEach(doc => {
                        const downloadData = doc.data();
                        const product = products.find(p => p.id === downloadData.productId);
                        if (product) {
                            downloads.push({
                                id: product.id,
                                title: product.title,
                                image: product.images[0],
                                downloadDate: downloadData.timestamp.toDate(),
                                downloadUrl: product.downloadUrl
                            });
                        }
                    });
                })
                .catch(error => {
                    console.error('Error loading downloads:', error);
                });
        }

        function updateCartCount() {
            const cartCount = document.getElementById('cartCount');
            cartCount.textContent = cart.length;
        }

        function handleSearch() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            
            if (!searchTerm) {
                renderProducts();
                return;
            }
            
            // Filter products based on search term
            const filteredProducts = products.filter(product => 
                product.title.toLowerCase().includes(searchTerm) ||
                product.description.toLowerCase().includes(searchTerm) ||
                product.tags.some(tag => tag.toLowerCase().includes(searchTerm))
            );
            
            // Update product grid
            const allContainer = document.getElementById('allProducts');
            allContainer.innerHTML = '';
            
            if (filteredProducts.length === 0) {
                allContainer.innerHTML = '<p>No products found matching your search</p>';
                return;
            }
            
            filteredProducts.forEach(product => {
                allContainer.appendChild(createProductCard(product));
            });
        }

        function showLegalPage(title, content) {
            document.getElementById('legalModalTitle').textContent = title;
            document.getElementById('legalModalContent').innerHTML = `<p style="white-space: pre-line;">${content}</p>`;
            legalModal.classList.add('active');
        }

        // Utility Functions
        function showToast(message, type = 'info') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            
            let icon = '';
            if (type === 'success') {
                icon = '<i class="fas fa-check-circle toast-icon"></i>';
            } else if (type === 'error') {
                icon = '<i class="fas fa-exclamation-circle toast-icon"></i>';
            } else if (type === 'warning') {
                icon = '<i class="fas fa-exclamation-triangle toast-icon"></i>';
            } else {
                icon = '<i class="fas fa-info-circle toast-icon"></i>';
            }
            
            toast.innerHTML = `
                ${icon}
                <div class="toast-message">${message}</div>
                <button class="toast-close"><i class="fas fa-times"></i></button>
            `;
            
            toastContainer.appendChild(toast);
            
            // Add event listener to close button
            const closeBtn = toast.querySelector('.toast-close');
            closeBtn.addEventListener('click', () => {
                toast.remove();
            });
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                toast.remove();
            }, 5000);
        }

        function formatDate(date) {
            const options = { year: 'numeric', month: 'short', day: 'numeric' };
            return date.toLocaleDateString('en-US', options);
        }

        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }

        // Modal event listeners
        document.getElementById('buyNowBtn').addEventListener('click', () => {
            if (currentProduct) {
                handleProductAction(currentProduct);
            }
        });

        document.getElementById('addToWishlistBtn').addEventListener('click', () => {
            if (currentProduct) {
                const button = document.getElementById('addToWishlistBtn');
                toggleWishlist(currentProduct.id, button);
            }
        });
    </script>
</body>
</html>
